<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CPM ‚Ä¢ Painel</title>
  <link rel="icon" href="assets/logo.png" />

  <!-- CSS EMBUTIDO PARA GARANTIR O LAYOUT -->
  <style>
    *{box-sizing:border-box}html,body{height:100%}
    body{margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;color:#e6e9ef;background:#0f1722}
    .topbar{position:sticky;top:0;z-index:10;display:flex;align-items:center;justify-content:space-between;gap:16px;padding:10px 18px;background:rgba(13,22,33,.8);backdrop-filter:blur(8px);border-bottom:1px solid rgba(255,255,255,.06)}
    .brand{display:flex;align-items:center;gap:14px}
    .brand .logo{width:64px;height:64px;border-radius:14px;box-shadow:0 6px 18px rgba(0,0,0,.35)}
    .brand-text h1{margin:0;font-size:20px;font-weight:700;letter-spacing:.2px}
    .muted{color:#a9b4c3}
    .nav{display:flex;gap:8px;align-items:center}
    .link{color:#9eb7ff;text-decoration:none;font-weight:600}
    .link:hover{text-decoration:underline}
    .wrap{max-width:1100px;margin:24px auto;padding:0 14px}
    .card{background:#111b29;border:1px solid rgba(255,255,255,.06);border-radius:14px;padding:16px;margin:16px 0;box-shadow:0 8px 28px rgba(0,0,0,.32)}
    h2{margin:0 0 12px;font-size:18px}
    .grid{display:grid;gap:12px;grid-template-columns:repeat(2,minmax(0,1fr))}
    .field{display:flex;flex-direction:column;gap:6px}
    .field-full{grid-column:1 / -1}
    label{font-size:12px;color:#a9b4c3}
    input,select,textarea{width:100%;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.08);background:#0c1420;color:#e6e9ef;outline:none}
    textarea{resize:vertical}
    input:focus,select:focus,textarea:focus{border-color:#5f8cff;box-shadow:0 0 0 3px rgba(95,140,255,.15)}
    .actions{margin-top:12px;display:flex;gap:8px}
    .btn{cursor:pointer;border:1px solid rgba(255,255,255,.12);background:#1a2433;color:#e6e9ef;padding:10px 14px;border-radius:10px;font-weight:600}
    .btn:hover{background:#202c3d}
    .btn.primary{background:#3b66ff;border-color:#3b66ff}
    .btn.primary:hover{background:#3159eb}
    .btn.ghost{background:transparent}
    .list{list-style:none;margin:0;padding:0}
    .ticket{border:1px solid rgba(255,255,255,.06);border-radius:12px;padding:12px;background:#0f1826;margin:10px 0}
    .item-row{display:flex;justify-content:space-between;gap:14px}
    .item-row .right{display:flex;align-items:flex-start;gap:8px}
    .tag{display:inline-block;margin-left:6px;padding:2px 8px;background:#17243a;border:1px solid rgba(255,255,255,.08);border-radius:999px;font-size:11px;color:#9eb7ff}
    .sub{color:#a9b4c3;font-size:13px;margin-top:4px}
    .thumbs{display:flex;flex-wrap:wrap;gap:8px}
    .thumbs img{width:74px;height:74px;object-fit:cover;border-radius:10px;border:1px solid rgba(255,255,255,.08)}
    .thumb-wrap{position:relative}
    .remove-thumb{position:absolute;top:-8px;right:-8px;width:22px;height:22px;border-radius:999px;border:0;cursor:pointer;background:#ff5d5d;color:#fff;font-weight:700;line-height:1;box-shadow:0 6px 14px rgba(255,93,93,.35)}
    .modal{border:0;padding:0;background:transparent}
    .modal::backdrop{background:rgba(0,0,0,.55)}
    .pre{background:#0c1420;border:1px solid rgba(255,255,255,.08);border-radius:10px;padding:10px;overflow:auto}
    .row{display:flex;align-items:center}.gap{gap:8px}
    @media(max-width:800px){.grid{grid-template-columns:1fr}.item-row{flex-direction:column}}
  </style>
</head>

<body data-page="app">
  <header class="topbar">
    <div class="brand">
      <img src="assets/logo.png" alt="Logo" class="logo" />
      <div class="brand-text">
        <h1>CPM ‚Ä¢ Painel</h1>
        <small id="who" class="muted">‚Ä¶</small>
      </div>
    </div>
    <nav class="nav">
      <a class="link" href="index.html">üîê Login</a>
      <button id="btnLogout" class="btn ghost">Sair</button>
    </nav>
  </header>

  <main class="wrap">
    <section class="card">
      <h2>üîé Busca</h2>
      <div class="grid">
        <div class="field">
          <label>CPM</label>
          <input id="buscaCPM" placeholder="Ex.: CPM-01" />
        </div>
        <div class="field">
          <label>&nbsp;</label>
          <button id="btnBuscar" class="btn">Consultar</button>
        </div>
      </div>
      <pre id="resultado" class="pre muted" style="margin-top:.75rem"></pre>
    </section>

    <section class="card">
      <h2>üÜï Novo registro</h2>
      <div id="criadoMsg" class="muted" style="margin-bottom:.5rem"></div>
      <div class="grid">
        <div class="field">
          <label>CPM (ID do item)</label>
          <input id="novoCPM" placeholder="Ex.: CPM-01" />
        </div>
        <div class="field">
          <label>Status</label>
          <select id="novoStatus">
            <option>ONLINE</option>
            <option>EM ESTOQUE</option>
            <option>EM MANUTEN√á√ÉO</option>
          </select>
        </div>
        <div class="field">
          <label>Data de fabrica√ß√£o</label>
          <input id="novoDataFab" type="date" />
        </div>
        <div class="field">
          <label>Senha do cadeado</label>
          <input id="novoSenhaCadeado" placeholder="Ex.: 1234" />
        </div>
        <div class="field">
          <label>Login Modem (CLARO)</label>
          <input id="novoModemLogin" placeholder="login" />
        </div>
        <div class="field">
          <label>Senha Modem (CLARO)</label>
          <input id="novoModemSenha" placeholder="senha" />
        </div>
        <div class="field">
          <label>N√∫mero do chip</label>
          <input id="novoNumeroChip" placeholder="ICCID ou telefone" />
        </div>
        <div class="field field-full">
          <label>Observa√ß√µes (opcional)</label>
          <textarea id="novoDescricao" rows="3"></textarea>
        </div>
      </div>

      <div class="field">
        <label>Fotos (at√© 5) ‚Äî voc√™ pode remover antes de salvar</label>
        <input id="fotos" type="file" accept="image/*" multiple />
        <div id="preview" class="thumbs"></div>
      </div>

      <div class="actions">
        <button id="btnCriar" class="btn primary">Salvar</button>
        <button id="btnLimpar" class="btn ghost" onclick="document.getElementById('novoCPM').value='';document.getElementById('novoDescricao').value='';document.getElementById('novoDataFab').value='';document.getElementById('novoSenhaCadeado').value='';document.getElementById('novoModemLogin').value='';document.getElementById('novoModemSenha').value='';document.getElementById('novoNumeroChip').value='';">Limpar</button>
      </div>
    </section>

    <section class="card">
      <h2>üìã Registros</h2>
      <div class="grid">
        <div class="field">
          <label>Buscar</label>
          <input id="buscaLista" placeholder="CPM ou observa√ß√£o‚Ä¶" />
        </div>
        <div class="field">
          <label>Status</label>
          <select id="filtroStatusLista">
            <option>Todos</option>
            <option>ONLINE</option>
            <option>EM ESTOQUE</option>
            <option>EM MANUTEN√á√ÉO</option>
          </select>
        </div>
        <div class="field">
          <label>Ordenar por</label>
          <select id="ordenarPor">
            <option value="data_desc">Mais novo ‚Üí antigo</option>
            <option value="data_asc">Mais antigo ‚Üí novo</option>
            <option value="cpm_asc">CPM A ‚Üí Z</option>
            <option value="cpm_desc">CPM Z ‚Üí A</option>
          </select>
        </div>
        <div class="field">
          <label>&nbsp;</label>
          <div class="row gap">
            <button id="btnAtualizar" class="btn">Atualizar</button>
            <button id="exportCsv" class="btn ghost">Exportar CSV</button>
          </div>
        </div>
      </div>
      <ul id="lista" class="list"></ul>
    </section>
  </main>

  <!-- Modal de edi√ß√£o -->
  <dialog id="editModal" class="modal">
    <form method="dialog" class="card" style="min-width:min(780px,96vw);">
      <h2>‚úèÔ∏è Editar</h2>
      <input type="hidden" id="editCPM" />
      <div class="grid">
        <div class="field">
          <label>CPM</label>
          <input id="editCPMShown" disabled />
        </div>
        <div class="field">
          <label>Status</label>
          <select id="editStatus">
            <option>ONLINE</option>
            <option>EM ESTOQUE</option>
            <option>EM MANUTEN√á√ÉO</option>
          </select>
        </div>
        <div class="field">
          <label>Data de fabrica√ß√£o</label>
          <input id="editDataFab" type="date" />
        </div>
        <div class="field">
          <label>Senha do cadeado</label>
          <input id="editSenhaCadeado" />
        </div>
        <div class="field">
          <label>Login Modem</label>
          <input id="editModemLogin" />
        </div>
        <div class="field">
          <label>Senha Modem</label>
          <input id="editModemSenha" />
        </div>
        <div class="field">
          <label>N√∫mero do chip</label>
          <input id="editNumeroChip" />
        </div>
        <div class="field field-full">
          <label>Observa√ß√µes</label>
          <textarea id="editObservacoes" rows="3"></textarea>
        </div>
        <div class="field field-full">
          <label>Fotos atuais</label>
          <div id="editFotosExistentes" class="thumbs"></div>
        </div>
        <div class="field field-full">
          <label>Adicionar novas fotos</label>
          <input id="editNovasFotos" type="file" accept="image/*" multiple />
          <div id="editPreviewNovas" class="thumbs"></div>
        </div>
      </div>
      <div class="actions">
        <button type="button" id="salvarEdicao" class="btn">Salvar</button>
        <button class="btn ghost" value="cancel">Cancelar</button>
      </div>
    </form>
  </dialog>

  <!-- Modal Export CSV -->
  <dialog id="exportModal" class="modal">
    <form method="dialog" class="card" style="min-width:min(680px,96vw);">
      <h2>‚¨áÔ∏è Exportar CSV</h2>
      <div class="grid">
        <div class="field">
          <label>Quantidade m√°x.</label>
          <input id="expQtd" type="number" value="500" min="1" max="5000" />
        </div>
        <div class="field">
          <label>Status</label>
          <select id="expStatus">
            <option>Todos</option>
            <option>ONLINE</option>
            <option>EM ESTOQUE</option>
            <option>EM MANUTEN√á√ÉO</option>
          </select>
        </div>
        <div class="field field-full">
          <label>CPMs espec√≠ficos (um por linha, opcional)</label>
          <textarea id="expCpms" rows="4" placeholder="CPM-01&#10;CPM-02"></textarea>
        </div>
      </div>

      <div>
        <strong>Colunas</strong> ‚Äî <button type="button" id="expToggle" class="btn" style="padding:6px 10px;font-size:12px">Marcar/Desmarcar</button>
        <div style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:6px;margin-top:.5rem">
          <label><input class="exp-col" type="checkbox" value="cpm" checked /> CPM</label>
          <label><input class="exp-col" type="checkbox" value="status" checked /> Status</label>
          <label><input class="exp-col" type="checkbox" value="dataFabricacao" checked /> Data Fabrica√ß√£o</label>
          <label><input class="exp-col" type="checkbox" value="senhaCadeado" /> Senha Cadeado</label>
          <label><input class="exp-col" type="checkbox" value="modemLogin" /> Modem Login</label>
          <label><input class="exp-col" type="checkbox" value="modemSenha" /> Modem Senha</label>
          <label><input class="exp-col" type="checkbox" value="numeroChip" /> N√∫mero Chip</label>
          <label><input class="exp-col" type="checkbox" value="observacoes" checked /> Observa√ß√µes</label>
          <label><input class="exp-col" type="checkbox" value="email" /> Criado por (email)</label>
          <label><input class="exp-col" type="checkbox" value="criadoEm" /> Criado em</label>
          <label><input class="exp-col" type="checkbox" value="fotos" /> URLs das fotos</label>
        </div>
      </div>

      <div class="actions">
        <button id="expConfirm" type="button" class="btn">Exportar</button>
        <button id="expCancel" class="btn ghost" value="cancel">Cancelar</button>
      </div>
    </form>
  </dialog>

  <!-- Seu JS -->
  <script type="module" src="app.js?v=24"></script>
</body>
</html>
